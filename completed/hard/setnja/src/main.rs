// noinspection
#[allow(unused)] // noinspection
macro_rules! import {
    ($name:ident) => {
        #[cfg(not(feature = "libfreuden"))]
        mod $name;
        #[cfg(not(feature = "libfreuden"))]
        use $name::*;

        #[cfg(feature = "libfreuden")]
        #[allow(unused_imports)]
        use libfreuden::$name::*;
    };
}

import!(input);
import!(mediocre_bigint);

fn solve(walk: &str) -> String {
    use std::str::FromStr;

    let mut accumulator = MediocreBigint::from_str("1").unwrap();
    let mut multiplexor: MediocreBigint = accumulator.clone();

    let five = MediocreBigint::from_str("5").unwrap();
    let three = MediocreBigint::from_str("3").unwrap();
    let two = MediocreBigint::from_str("2").unwrap();
    for step in walk.chars() {
        match step {
            '*' => {
                accumulator *= &five;
                accumulator += &multiplexor;
                multiplexor *= &three;
            }
            'P' => {}
            'L' => accumulator *= &two,
            'R' => {
                accumulator *= &two;
                accumulator += &multiplexor;
            }
            _ => panic!("This should not happen"),
        }
    }
    accumulator.normalize();
    accumulator.to_string()
}

fn main() {
    let walk = read_str();
    println!("{}", solve(walk.as_str()));
}

#[cfg(test)]
mod setnja_tests {
    use super::*;

    #[test]
    fn test_solve_ten_grand_star() {
        assert_eq!(
            solve("*".repeat(10000).as_str()),
            "751855912380967801394633390061446662398235167200763875913214356341885929\
            6426176060283666044372633620042282773929308755812199116476533690952472325\
            3432193671778811313666740918434077316760316002200660328912153743684358244\
            4568591134871034093477185632902318592569642158822888313662303905599885935\
            2501175462367109136703980607929989134634928322753837287146801927230973941\
            2363207117068122625818330052478455988355969655796299726301950763431580908\
            2241346754853056754013654805988057914893028334152409985529207112545763257\
            8438817429977085346473115969848849128582622853604158650282360902042897288\
            6548061859870453814303420972917835045768558515503210036089232857778754044\
            9417799652208344580216048436179265245454718435498633244540653399235485475\
            8587695383523522205573546246656674510854732177614646645639087053282178135\
            2724264314727033839807329253582997818557563847883869339175744061356740305\
            2239281985667715526612666418213272731510157115993838777464991499888587588\
            5607399836971227742515463095964106732601236837971916414237540818321870785\
            2056436083355855796596062837222764908844886085081656373643383766508307155\
            6358179233174203205881811114620539432631572185363008613260469345910779475\
            7098747118332410615932330795573581872889023504784378190468748980361471813\
            0924213278406887855414329373445499960572351541761690990193376796055163444\
            3452540012729995712985194418972650972431342188118528904668827886141508161\
            3661664406961472136471966449487242581538468620321659658407596508750206756\
            6025650461260895716822047112329445941943489461401288730503838816666713419\
            2728785326217316122453863793000445367852956986164535198416366552106913264\
            8696317487398425380915791953654068712482986474131044437359037762894044347\
            5166431634531072551439706181690259579281448543103267584028615381848895201\
            6308174615097914652146846567829672600061912903684253456540375039704238469\
            6645150345963224909840347522402123776019548115316168650746685354634026869\
            4908219670723710453346620634724589279317756535635181859965945588829450664\
            6764027580164187692973361444963656024145601287418296828473481811621248515\
            5644500673247848829803976131782507660281334756504479548146439126718009985\
            3036621001406268798749077220844800155349281226247888248108856080692758821\
            3062226338418288685790961813140423845344683665635047514986016587196500355\
            7973295947297844589909120943042328241579887149989699042100108521970739407\
            2506931370900130949480158398265998612913758678028562993303253239670380037\
            1729762664657283257880621556854359461334343902796842930593586145070238476\
            8579436022304319266160798816499399359913140674316490031721445903653763645\
            0885879527980727439747423231731362354749780349295891171047761306124721843\
            9997669362573446539318423342175875267790334274477116343419257406789339787\
            7958988570877768893204418575467025857299988141540888119683178920972489563\
            5487463366642215842178807603857121889159312995901647002373988052020314022\
            3755991557485879450871615695873324010602371830188012781253710378122561282\
            6147195411748723819110298036810229163658900056725169436973610233354208706\
            8232702138699291031194317313451132651942356983188052805441619866287137330\
            2821562706548534272428688830481517836870468128296710920375020600750376682\
            1951359745656748258941771881232444747192314369997573122859531135063774589\
            1968948869872626914013142487868872465522491260972541600734213753987149701\
            9327782326867384639087130154308265758496724820863045600146419847776774802\
            8454670947649531141249456522788958496556461444182816028803176712114570022\
            1763822163313776126857636504956182236063841820193970728685056638204274182\
            4930578018969135087595194323399316645300127890927809399159262546574572607\
            1988128208369920677188075860903924894518031662295489962384676549046314885\
            2460530226168780086377592389790499256833429905277358618172016802154272382\
            8497133315687991827395623646937853016172570121177856270562190001362343043\
            7970135476004277160759125093373761815347317630028985167211342079675928892\
            1710939802125692686494743508118667219016271218375028176129716325388333491\
            4407696822962558303617745049761675794458798945732842750638506765526948132\
            6418169186337655250701857586234161590271005098699450660912149476773077266\
            7634299674489763069121708584792594952348868315999984106864582878917877608\
            4359446368866275397645306359675929138203877578394503182774590492680354866\
            1587762733680949172025605844285277709370793796490515244199892670974513643\
            7839801584856889344228348410992711928057619279673655660052808096530901745\
            5716465969456281063967632109301838167949951394146911009205178253277049707\
            6073263329124649221153128850167807172269511528509766832330887439788709126\
            3336389421055821210048458703970926004713352356747821967351518851480996473\
            4451491140725644643486442602330327880575625093234914498212917134739982133\
            5607306478626314276873106828250207220254681801284131520010464303235139777\
            6085060234996868657790844277432927530912417225029788692013604029531410061\
            7517110832261653012812225528919912022873607168544049956574191842520270350\
            4861383999026830656552581787305364132308466315197115273385197755961291406\
            8490255135711985472725425781196018502783896067620997222046402929862949714\
            5642209021081906515949204766147609199743308867992800822849444520785328770\
            0866837629013058079737621440145474387812844709482884305110607679085368464\
            2139330480793090013461730073055988886218173324101577748157865855032875912\
            6049136369713658046834882501000106522311018189588438434935396152259905601\
            0263888643985823393813518566694319773546875508013218454780271349797494104\
            6498801849768308441994912342038584991598714839507381040164516134781171118\
            2591908386549170184489359024447352140587619370560868622109838679516735081\
            0005820633599657953261248132811824321378532179826787988995757070988542531\
            8399680157724058219778975534214527453272344868821622704018634900577657140\
            3400677033320995548621162632454834924067183116881807063216102373290521861\
            6958382971233882159439585587688957382588288896718955338005719450817473083\
            6680939866511095606922445864958776229858837956685762847376460064213275211\
            6390461383773606952180395671828069400191761553401726413889074969113236260\
            1839307531125682870480793188339217926101138394524702603537534499201889392\
            7989936818892807268768334504521909403847574445715225445021346231737079750\
            7034498652292087789709256727633131472856395887317727536484835839673307333\
            1602895821295362029795855919459905721631257407586771985772664158087552845\
            3392096273353315881695086060539378012157276033751383647266198517760462240\
            6091130288542324855491684405804465809445195324769615309565635961281403802\
            2361257918637487706974600370001759411138253032064954480665439747251612190\
            1770608807554930655501081146065589917063895082491855092715568806360062158\
            4765926424209987545033485719712027918837757316004906688321872416973570923\
            9471982518382263985580958996499949777894331296005298093088325098465746996\
            4689504233831917269540787355364175544230418720897787043248953234620615713\
            3243059337205619447635005735040395948440820541599967030862405706296275866\
            7466358050697670293519481482281917687640878094667173991926413219127451444\
            50215483541827527417570540170293468210204307000605735937"
        );
    }

    #[test]
    fn test_solve_maximal_star() {
        assert_eq!(
            solve("*".repeat(30000).as_str()),
            "1888953815376137185937296177822806088837754370378737561863081340132609815\
            50309460405795544827536839512504002613040097010846188704103958945072801036\
            09022108944325817458923866773387137472552658928961540316393293233679439385\
            18418549215971935292169921238971195495787067693728226659726310406442772879\
            11983980734874506180500433626325096981152921702436550035328717692616354985\
            81973340605357572399610145899602287258309771171009526192338133380081366742\
            38450041719417451803667318136243770654615179618872115812108764729683022005\
            55836597952165516678309738506723985309528536532709507328023128984602325336\
            13472472379846671236963417322427971720030234783918685956045484925027616672\
            78266860159385552757311340740319909013234307656896988980566283649413150503\
            90034213654076640257267251972822736688118789267840684929187688798607882626\
            04251468307676246380252373698945358083481836863510598800715113571132901960\
            76042128646408402378549226171139671792372045045367776891713875374160446724\
            24262437617394621952267167245768095288781278633521378603058789530958527679\
            46151701131093898460035298490295468072756619847041371079627918374679765721\
            33654793792193858030975142002632969559938261513360550089866739884943555577\
            37068984739318399481154057108052416407095591319117792814269920021357373099\
            09544360389189721004941980927619290269911198923743104933520604136877802391\
            51820431363058601403197920011669641771789864386811437291334725564286837248\
            14862913691973980265737543625411164857440655972061767513546074308260688003\
            93650966222721653259805385324917250598246310462463671102150825587249863602\
            05955142637380203342577367335401066572736382882843615379129634728845819784\
            40345716428314554374375926785661323739073465191963177934285362350751535319\
            02121266129208494987902856209539421628444328487047140952405913442283535945\
            67122541051623424133739969945186875379424846206869598747042300622725146993\
            97693898681893818253079260545546676514773536090001833467366735483741339705\
            76691082475207526992283920041859791685945891229546685865194046834434235973\
            39112645628735637079686858480121930996227897102415669696799585764038097078\
            42573090983901603811231811559936344120971830388282048975468713302657975231\
            84044390062694546818960441632060758000614314446022251200140658687653894848\
            39847115741512900848759247883632809365504187217558026124432688898321209722\
            32497056364649018987646635494929596218603559810219301897165330046059123202\
            72672008344540515889605812325403900777521013949213064533657020750059261542\
            44196904652166870777900677830547028132721327491285898679063030918826938165\
            76265200112173271938600740779135883041382425760001882882471471825026659518\
            76432946789983139417500338937941354620042911546116387626844319983905345404\
            46235662208279026726174432054866314347257787022771655482134907719358312739\
            76364843701725083417167215665663750950873921465152554894842421558099067140\
            85489042323582777991313863426892183935935610704353224921540316166889868062\
            00909635351723340263439219810206785314316638354722644023152451730548816154\
            72431367217043713408331653505915208170356161898053383072720671773033821058\
            56870021501936871946246677199992985369488632347113894520836580093725180594\
            26961032475222867956964179266157947227736125750033983497101421896484689786\
            03804001060992359426616458951638011485683374628990210153405639407205689150\
            87415709271785856587339749662832518605562760694168244138933441502321351185\
            94959808577600526876805679957623844275427743146029339341159778453496030186\
            35240998249771020670589238569907471145856405910169571788434543508083405980\
            16118332301633090143750672761706025374167634695469452463277959260287030978\
            60893008811042618116932872083782313032110871541942133034602210982557847535\
            15641701119922476824223051525521452609225450084139810520375305026613100177\
            96039073344360677879023653473385894818645313356160491454518500456435700108\
            89821270701403300646733101161960260954969842792969914502919905782023427824\
            74815587549152905653848005447535008771745010428620145360049509719281721350\
            51195314614318389872482977254096921373433450671647793141653256079736903283\
            70662478410441846283149481437632588674261512970826242893013956804084598943\
            83825063329970887613170943986794506732102950684283166092009443568652062845\
            41984978273483857859268302864023785350023129042592449797804818619402183655\
            73227271939134334325051720346790330794711555343266525073580510372588971733\
            37988025294483336876740576250571022289006401294710850742965426068096500670\
            45791342735181833708342497247786309970893395616049909714818025150198018995\
            27451731489894382198081873856593285146440184333489689553773954668239275588\
            13240949887355052511936081345900497808217519561447082540672443651999010585\
            86736665254022302820684093566423032076965150018701682421332138738357462413\
            26393481566829281298034245306051218594613912763440113205680019744620442672\
            46483079819130015910987528082584563528920570383669991730241900978205339226\
            03809357143973065039037266806994554174175806450034069050086560062302924021\
            07500242419116521833060241318643216942430785547274849882918173704478834017\
            76722466793419320811868143129130007938358342938435366379682100555636211033\
            11812490289419569296850478211102936038657596999233414154721048086490429012\
            66388963361857872059905235534385147874770067623685200146950516336957476106\
            44843213479714650057879117485404501424679265321074220595368223998065418810\
            55941000824037657846130416778463009677821752229572605303447024789447452002\
            36678188435666031917830386836649985782992674296404797645921751617588701902\
            82396855627434064993053214810165791472436846322620208947574850183026496173\
            13865087868062892001124026696032430305319409687376817858979277810939178612\
            32163874375872915265424037301217454339671954476669162241774552601337102049\
            09794486533190758208416055617559607217670867077144963776590639227504576424\
            88490934018595179625840123880279195245995574731106109540064729925974988134\
            15857801968609645148216329543695964423646816898863848338596995952461141500\
            42015935740869000280095650968296049125170273721452396655718563262225225371\
            91922974796404365707161337245953748617628389197641676747074130462498009859\
            01622890471735876122966108789311341340543319902656196260054044510163312778\
            44415430065088244073929006036502001881296369465482441640431328050546969310\
            50655483131766912012399927958726694834149345524993129937134084549599921128\
            61048895887193184080888758735777330023851217194982300412000500861840094044\
            95129825122473868530623051586935179096929361894891577169602114217927666540\
            30165062381437332846608925098993247485843511095825510320359144069737657477\
            95216741299719100361158442587858634344478836732255774148984030785818456456\
            00182824670830918000121465115399920619352827316076090848046690571423847455\
            63224885082260890355613551534065968391713681753550698206402858226657450269\
            21505169138171115573177020451229689400975386782953670424589760804213686621\
            56617233739576542161455491778421053984657119678754490614145996031051218225\
            63228298600247725393994022703127480178629275761164267824167609092397521412\
            62466047954363973355406912563250554145730164156743491400875831776962833802\
            89657911711670218188629477213683388677911424941368039074922798550978886880\
            95359339886389293112119014494448784778803602508496873967966843022446028281\
            21918086197739765230522154701093040651685869864531594325797510000393103579\
            65368893646281627935358192022262010774489912105873329494338369723553922553\
            23404131711539756805821869142742845331480773296310773717637525997230618836\
            97341981084408678771147715398875361670154536637441341295091039912472455130\
            37225304116241748991172485849922735293331606633894364907961075369814458354\
            75404265970582697393418307000024892588317248030369599716664215802190124460\
            03319409909175957360356607785260116926480016139633105270456081261543873049\
            40337692614298776548842280328057224953208609722658521104095074547119538869\
            79176045604681303613641531250165208431553608362339454590234833663602615962\
            85709862377211195185893947803007863218041004508172252605292888726056962534\
            17675477389604841435703088386882498592134940262383004285450626847338668732\
            70317682801426616890933795832397054981669208473506409255922509485645785717\
            13274588447067075905360417307906428881978034537113375224696097640515109915\
            25417955510887341259733214173586334241093823931932974066342370846357337963\
            87374848324832796646382476784957446291641684788199422262208281950887105279\
            46727690835613941199370260341611860925040024912694359659183744089699976102\
            21290607354839690487472782842498364898253918095290461481385991116999099039\
            81628500125929497353396332543186220197798008229770168437913418322508906804\
            94202648625826688689611620889000828602441157987648830074536701171745606769\
            60657562967475939874246020228739161810128693228444489896373569145694992322\
            46784131167316728847241111668163806278240009813443071042512205144108605171\
            80078745752650506077324802927464784820778773255648699575776887174107438937\
            05661651133232489613824771052655862450432987229384281548709874196966472823\
            33557666370647280487628456354332387711324043295170344657691305651355769302\
            18043664853753141923450341787403094440216199275150248134827586722090882180\
            41673559792061464180869588929346893591525285730816988857083393341011446195\
            12353117110782769225699054368436483178585824375314828214688927738987130812\
            97921400418135803823896664692706217691910071225130210440232002847052227047\
            59350299447439651655775966616981535878720211979123021103036515215651348917\
            20666056066654963296174689720521111737930182914473897114706452136416083736\
            16476666726962238816692412026284607386668643134742996432828723485653186998\
            91881958401334459500275002143373100487188132698835385128362549422821763479\
            21795512138593912347329082908455057026257620171356512251061146192147190126\
            85623690719509320415607753882436734442640292936975476300718407156297044876\
            10749430077557009403519544388672979084786472611704133823339400888315402771\
            47586950807630680960815651350061917004357668785657195361358491746484611595\
            25512032018262071949231029539032916129886722054122231172141659313549270821\
            75916305677264527561801932485008426397629543261670095239008662488770328441\
            59163893808545556956525393388362456404602450427551293965088802013508605633\
            16021122595648971962830544852671779573012637638159286824081876882113203762\
            57933636779085773021726720838385724926042801422379325088547521369655600879\
            73815538878790181152957933620647796792008800742331848280788278787042608074\
            77199843744317473278104321396565505601444553132266660569016372901908125153\
            64063142193219612404460474405431744625088817312630207333000939999156139424\
            30455983447362590170060975987374515881320605168602814287113635325739143347\
            81179185035722185768443848367770756684176453880227247408981777253738326591\
            84966250242356264582194235391100400179459632167216727019525079207068642793\
            24442590164611092607083434003366121811754143123484442166495548571823038002\
            73035838640313449085451711570268497839068888307434015751185070556170011505\
            78822602632811213504437036239151620377385701536981319341187881300408982223\
            87044218799093426233213459531891747233339259353879375419630584187538303186\
            67826328441763778545412486537071687387615525965763037671089534174715137430\
            98030881644700462971035264108473291646882431381376243648813647518212502927\
            63402896890669463835945199453659250346480261021782192465588069486619786871\
            31745028336919582845310266335002834982777926543972110165580735077611849748\
            28553794871833093756518283710095060687115960266781723665534339612118213115\
            29724668337737118009558465572524198178858216322298003421009437948547462393\
            05304750449041173772437017385310840458576946154976992763403910871269021764\
            71902033551702502203292227796328218910021509963981261991087874122433261688\
            07878066518334088197316558019983836212206519309956270460377879947039319747\
            09906927601347032589862629991254878057343908552177738482045509589165264506\
            53943102954750082940317774423037745306299972576379752174517387032247360810\
            50260023639651180473932321222815506739706433188915545314889692866434543195\
            43392106473627193427760229554536563454774165126011087928324173595389871334\
            59060170484876710363349775183756508905353657581805892491627785371177771027\
            12837924928638275720839770066346746375200885238119861588231534181632123574\
            09988806743275854805917991039405613625715451816404319314423100303743260475\
            19843038864866648862882251239746151319239793879582909973029597810761610020\
            52421050311910389929055752459637953670723635677074287086131581735573419247\
            01929808801891837655649483200292200187250804330822587588140328718704254342\
            72488706197149562279660423841566535283670329831912687692936304183967191667\
            55353209373975967941889083916512301795962365524602760379048319470464667866\
            60617467120616813090567944115335885011749470201290099703214921581420669119\
            51839559670925497916641056122798391842062282360084346001495560561516716982\
            37913382505750795142696744724822598257355878398489126929610908749910599248\
            02991607319418957138768647176878590395888949363097443408353275563768223812\
            29979127038624765861585423245440208476595438738498256504053723162215679912\
            82897096769513826204030676205966860688177186289651034239645448903654604424\
            98589087680560447544724423301663518912006148772276197230102453678962760854\
            18821000527421229039695971646148302674181161827537538057258069822753312696\
            12338302192485967898476310929456092608271138956306225965614672122888983657\
            74064053838994702552724312972666093964626058707096356911745564438047503280\
            98628156152094516720411444697428950880558841508701964670395946732608686480\
            49778456481282703790081388182716581450264132645241149329643086711512991312\
            17251810062580570674429393400985291086783040357512576395304144072152114760\
            80252961371926193173962122048550108544543550310322338046124855776728132047\
            49671649054380644440884372060556371700622393111269880866558145215194181645\
            80114390838137434701324358556634556952195973218010795550185839355838322654\
            31196001090567702093518094694921582141942279601721454672420436054455784075\
            48679911675731320975061263935442258437798371946248475047540371846950491750\
            99210895913088585172600214830418311099607250159268914000045803300630357896\
            86453088198359487012250909247886153437334480003482815245231429305945880584\
            48284983808564383725891611195133862631135386155835814598553872545088891686\
            51700467546810764401758698681961644853599011197059843431318701360166987779\
            24477190099781507287618027407505710084938306278445950203146992599669264973\
            43039021537397914197649424213858057574625291378118463258879423459900649149\
            93843557383535960123369412490337082207465490714702315550833747786061971433\
            55396178534445656366661459611348917609944266360396292879513902786463886775\
            27164002035411567038253158265436403193226506373862747056575446677884917034\
            65101392882795399719708169046124335154467370729977235089069033690379070478\
            86659657471788208199359381810555557964415775204329433775113392787321207048\
            78403884719623224383618036780303381197667942982181239493264677724571856903\
            89987170727142118214810982582639108626108425460143411045878509021119165404\
            67864679214022440768120896149841410623691050549435380141442620851242391111\
            92344721659174928276288767289915201640208347695228357173317499005990613458\
            11962854424311865065627408247599541337889307267728296113884589561603905142\
            37109253646616820990820453552607091274121003568564316444930557829777633412\
            31227923564200222520072750211750328247860181082060465044385572154708727995\
            71322503563580950272515234509534886008586600544354034450494074154210478771\
            45736478990747217485553262652305855337662842883844370044505969160775939865\
            27321953408828695422040862166938666810801987010713353803778430321245526610\
            02722111895089120050370159954610391484824926238411517029384507668911473945\
            93615263319854039046151016089618116382053799732278937870033869528389425779\
            23551585554072907741429309198450851188577053575777218902472924758240131034\
            75792673161595896563132204783124401295056642011719083788371494177597434221\
            46310123545011461831930053568098710163689659392027497768493054487610287291\
            85574582718151195228740734729124786172962380827463867126530237965909450874\
            18526878031207624349311286681722946638806613450618738198203217164156985333\
            65527534548355606095873165889420348809356436255571978695712683443786592264\
            16732448300259835840194558724326573254261719530834016589561151702454635215\
            21047574893827760126964417375698686125000750804052006472054856497732625720\
            94796661068377611971836134080631090876987221779598326425219249262641865343\
            75746158512433192741766757945620994360792829735800740316927148127774232022\
            07611523328972373970419951426914646657850348309271203214003761280181801531\
            46609073341889075409768538455795806402290578449893015202901642806709606608\
            51509988099952304884690206856450808883573399954117488840865538011614824618\
            90531971834956289504350254679930751007428936721271936551652019076232593121\
            53471780342946319098739292999702296978307061714004548952155719345050604298\
            33328071531343827510087912164046276305205870808432299956979516878182843395\
            20089711850587977947136149459595565068559951881130909593032335190570461176\
            03358036444650267884056015709035308992201168501291524930165321066933666025\
            11696168696847651387695566672832912099402478762761930911354618374511371760\
            92866928507301592134521435434680233749886812535350896064160742657432643295\
            33189897810861218358947701682608591512713022473694069646137743019900759222\
            12950599754184191969055029506711577753054943957863045636852904442036749715\
            24607691620637584201755557912423683442172515260741074067171465871242237096\
            62951508228699398549260462763492642157744555472346235892930484183451704552\
            85489341192688155457684374758051896415026746979826566854640116105469181029\
            11846029783307836809986317034367683946752288768828973497578977887378717385\
            90241524970842533076902028080891270723422524047069404457026940371110205249\
            64940038039289094115809239753597479488189967591766640531560858721739796626\
            08009039951803433235618695179386947347080444780670053435429393004369803392\
            16215385407798515452446237765072285735596467209705642926715136573025509766\
            97950997676656502988914069116336326792919958807547765437890063948077844781\
            58619923476384595226975106097173305477280106157091564323846955987531281774\
            83990547879844093129646720731731060537856908883813807614982549063919519280\
            11123159285974545821472475756241152943248720039761723919940049115755239652\
            53732654437248428112536932280229739633362691647692230369024573278823086733\
            68697803212627377928712778918327321788375567950982562971812384989915648387\
            92694214282015563871208288524715251746880502551517095852432518214636717788\
            93435132526886049712482151148228462164231839852450752385278522503651270484\
            82758135615592192302751546091373332607688136894017329133836826284454672052\
            16694147745047702180965783862455633226174506411114473985244043407181805000\
            67970101592566356114520304785359272067245567589253768807613611031803172574\
            70326083391136346836203218719581155288883304960121316673091098967753862250\
            73307737101784355754309397221427500944342347124897475930980508524872704080\
            00128276226993627109063351091182542664078405848997531121305322129291867434\
            73392658946933734479095373134337749396515628623695418385790742066208787557\
            92216168790867723308478317553775835347926372432538514796314607644442845724\
            78041043218882077425494284285703163685911369105168171347438042623818628823\
            09119841808842213539753744536723079868956760578986924967347104361682703823\
            06804074893203088230582803186759261959884905657445489564908502820545060471\
            86656148495011315042582097146352302914877998227545058681149106616980837826\
            07068446944861691976839529777437381482923138117114207189905041615092506963\
            62637533181067708996111316951041044611719536619025124747942469310281859965\
            38074318352284383190234259723564379207479827236485526057900026323221164013\
            13276478523149329452142290276744978671114490180453301700994148632903390176\
            89305786463433561966415521221106204922325541363644997906710937418129411137\
            31404577986451735374620668674045120239852325329917271813074092112725797181\
            75287733737949557695081104264517291849088858174531839780881373367551489127\
            73560496162028097470747164276095353775547122549394435977580041569114061012\
            87865487819823846462641325058671415261893106461650630944889742373547260541\
            92681253992990394750244012676191049210192922587662502068894993139392644978\
            11533871689388056123778176971246546688413274387303865648518590959453804760\
            37319837483519336870134961357283155420185261863383007941937412966017563357\
            86139967490764022739990082488292059911062240672834714776398759394492715829\
            10786508274305614887700890798352338990614067925580321697753462350490939610\
            80844899315578623619555742637660456375985681615441526652229478835783324010\
            08411222943970848876948687164393584383992950013639232974474983976246094455\
            49438251008160319797622983380991489359077892073967896466667065914724437138\
            92400404100016516879851542592871426363186868998396220340747695271550931859\
            10499372144529336256253510858096388449198909030752361574978930296040826391\
            53514720861104167490071812470989129149985565441028284181022124539527878807\
            64588477629576289758324536217823481570937354645312858881453539615572157931\
            77562636377550556395202515425051088266906996697846126243572684935060412115\
            92220246400284065773397219367010002599900728628034984663350555938642269657\
            98922154399830163895497081106688183716096391779371001971584303549576353418\
            28425756005435966487178535937"
        );
    }

    #[test]
    fn test_solve_middle_star() {
        assert_eq!(solve("P*P"), "6");
    }

    #[test]
    fn test_solve_repeated_alternating() {
        assert_eq!(solve("LLLLLRRRRRLLLLLRRRRRLLLLLRRRRRLLLLL"), "35400942560");
    }

    #[test]
    fn test_solve_left_star() {
        assert_eq!(solve("L*"), "11");
    }

    #[test]
    fn test_solve_right_star() {
        assert_eq!(solve("R*"), "16");
    }

    #[test]
    fn test_solve_double_star() {
        assert_eq!(solve("**"), "33");
    }

    #[test]
    fn test_solve_right_star_right() {
        assert_eq!(solve("R*R"), "35");
    }

    #[test]
    fn test_solve_left_star_right() {
        assert_eq!(solve("L*R"), "25");
    }

    #[test]
    fn test_add_zero() {
        let a = MediocreBigint {
            digits: vec![1, 0, 0, 1, 1],
        };
        let zero = MediocreBigint::new();
        assert_eq!(zero.to_string(), "0");
        let c = a.clone() + zero.clone();
        assert_eq!(c, a);

        let d = zero + a.clone();
        assert_eq!(d, a);
    }

    #[test]
    fn test_mul_zero() {
        let a = MediocreBigint {
            digits: vec![1, 0, 0, 1, 1],
        };
        let zero = MediocreBigint::new();
        assert_eq!(zero.to_string(), "0");
        let c = a.clone() * zero.clone();
        assert_eq!(c.to_string(), "0");

        let d = zero.clone() * a.clone();
        assert_eq!(d.to_string(), "0");
    }

    #[test]
    fn test_mul_small() {
        let a = MediocreBigint { digits: vec![2] };
        let b = MediocreBigint { digits: vec![3] };
        let c = a * b;
        assert_eq!(c.digits, vec![6]);
    }

    #[test]
    fn test_mul_carry() {
        let a = MediocreBigint { digits: vec![7] };
        let b = MediocreBigint { digits: vec![8] };
        let c = a * b;
        assert_eq!(c.to_string(), "56");
    }

    #[test]
    fn test_mul_larger() {
        use std::str::FromStr;
        let a = MediocreBigint::from_str("123").unwrap();
        let b = MediocreBigint::from_str("456").unwrap();
        let c = a * b;
        assert_eq!(c, MediocreBigint::from_str("56088").unwrap());
    }

    #[test]
    fn test_add_small() {
        let a = MediocreBigint { digits: vec![2] };
        let b = MediocreBigint { digits: vec![2] };
        let c = a.clone() + b;
        assert_eq!(c.digits, vec![4]);
    }

    #[test]
    fn test_add_big() {
        let a = MediocreBigint { digits: vec![2] };
        let b = MediocreBigint {
            digits: vec![0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
        };
        let c = a.clone() + b;
        assert_eq!(c.digits, vec![2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2]);
    }

    #[test]
    fn test_add_carry() {
        let a = MediocreBigint::from_str("1776").unwrap();
        let b = MediocreBigint::from_str("76").unwrap();
        let mut c = a + b;
        c.normalize();
        use std::str::FromStr;
        assert_eq!(
            c,
            MediocreBigint::from_str(&(1776 + 76).to_string()).unwrap()
        );
    }

    #[test]
    fn test_add_mega_denorm() {
        let a = MediocreBigint {
            digits: vec![MediocreDigitSize::MAX / 2],
        };
        let mut b = a.clone();
        b.normalize();
        assert_eq!(a.digits, vec![MediocreDigitSize::MAX / 2]);
        assert_eq!(
            b.digits,
            vec![
                (MediocreDigitSize::MAX / 2) % BIGINT_LIMIT as MediocreDigitSize,
                (MediocreDigitSize::MAX / 2) / BIGINT_LIMIT as MediocreDigitSize
            ]
        );

        let mut c = a.clone() + a.clone();
        let mut d = a.clone() + b.clone();
        let mut e = b.clone() + b.clone();

        c.normalize();
        d.normalize();
        e.normalize();
        assert_eq!(c, d);
        assert_eq!(d, e);
    }

    #[test]
    fn test_simple_mega() {
        use std::str::FromStr;
        let a = MediocreBigint::from_str("211111111111").unwrap();
        let b = MediocreBigint::from_str("4").unwrap();
        assert_eq!((a * b).to_string(), "844444444444");
    }

    #[test]
    fn test_display_bookends() {
        use std::str::FromStr;
        let a = MediocreBigint::from_str("7700000000000000000000042").unwrap();
        assert_eq!(a.to_string(), "7700000000000000000000042");
    }

    #[test]
    fn test_create() {
        let int = MediocreBigint::new();
        assert_eq!(int.digits.len(), 0);
    }

    #[test]
    fn test_empty_is_zero() {
        let int = MediocreBigint::new();
        assert_eq!(int.to_string(), "0");
    }

    #[test]
    fn test_is_normalized() {
        let a = MediocreBigint { digits: vec![] };
        let b = MediocreBigint {
            digits: vec![2, 1, 1],
        };
        let c = MediocreBigint {
            digits: vec![0, 0, 1, (BIGINT_LIMIT + 1) as MediocreDigitSize],
        };
        assert!(a.is_normalized());
        assert!(b.is_normalized());
        assert_eq!(c.is_normalized(), false);
    }

    #[test]
    fn test_clone() {
        let a = MediocreBigint {
            digits: vec![1, 1, 1, 2, 1],
        };
        let mut b = a.clone();
        assert_eq!(a, b);
        b.digits[0] = 2;
        assert_ne!(a, b);
    }

    #[test]
    fn test_normalize() {
        let mut a = MediocreBigint {
            digits: vec![1, BIGINT_LIMIT as MediocreDigitSize, 0, 1, 1],
        };
        let b = a.clone();
        assert_eq!(a, b);
        a.normalize();
        assert_ne!(a, b);
        assert!(a.is_normalized());
        assert!(a.digits.eq(&vec![1, 0, 1, 1, 1]));
    }

    #[test]
    fn test_normalize_into_carry() {
        let mut a = MediocreBigint {
            digits: vec![
                1,
                BIGINT_LIMIT as MediocreDigitSize,
                BIGINT_LIMIT as MediocreDigitSize,
                0,
                1,
            ],
        };
        let b = a.clone();
        assert_eq!(a, b);
        a.normalize();
        assert_ne!(a, b);
        assert!(a.is_normalized());
        assert!(a.digits.eq(&vec![1, 0, 1, 1, 1]));
    }

    #[test]
    fn test_normalize_zero() {
        let mut a = MediocreBigint { digits: vec![] };
        a.normalize();
        assert_eq!(a.digits, vec![]);
    }

    #[test]
    fn test_ten_is_ten() {
        use std::str::FromStr;
        let mut a = MediocreBigint::from_str("10").unwrap();
        a.normalize();
        assert_eq!(a.to_string(), "10");
    }

    #[test]
    fn test_normalize_create_digit() {
        let mut a = MediocreBigint {
            digits: vec![BIGINT_LIMIT as MediocreDigitSize],
        };
        a.normalize();
        assert_eq!(a.digits, vec![0, 1]);
    }
}
