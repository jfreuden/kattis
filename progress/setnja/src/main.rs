/// A struct that acts as a peekable zip on peekable iterators.
/// next() returns what peek() would return without advancing the iterator unless zip would return
/// a result
struct PeekingZip<'a, 'b, I: Iterator, J: Iterator>
{
    iter_a: &'a mut std::iter::Peekable<I>,
    iter_b: &'b mut std::iter::Peekable<J>,
}

impl<'a, 'b, I: Iterator, J: Iterator> PeekingZip<'a, 'b, I, J>
{
    /// Creates a new PeekingIterator from mutable references to iterators
    fn new(iter_a: &'a mut std::iter::Peekable<I>, iter_b: &'b mut std::iter::Peekable<J>) -> Self {
        PeekingZip {
            iter_a,
            iter_b,
        }
    }
}

impl<'a, 'b, I: Iterator, J: Iterator> Iterator for PeekingZip<'a, 'b, I, J>
{
    type Item = (I::Item, J::Item);

    /// Returns the same value that peek() would return
    /// only advancing the iterator if Zip should return a value
    /// this allows continuing the iterator from the remainder without losing any values
    fn next(&mut self) -> Option<(I::Item, J::Item)> {
        // Return a copy of the peeked value if available
        let _peek_a = self.iter_a.peek()?;
        let _peek_b = self.iter_b.peek()?;

        Some((self.iter_a.next()?, self.iter_b.next()?))
    }
}

/// MediocreBigint is a bad implementation of bigint making use of smaller limbs to handle carries
/// Each digit is base 10 input or output, i.e. between 0 and 9
/// The digit capacity is 8 bits, i.e. between 0 and 255
/// the carry hides in the higher bits and get normalized back out into the digits
/// output must simply read out the digits as a string
#[derive(Debug, Clone, PartialOrd, PartialEq)]
struct MediocreBigint {
    digits: Vec<u8>
}

impl MediocreBigint {
    fn new() -> MediocreBigint {
        let segments = Vec::new();
        MediocreBigint { digits: segments }
    }

    fn is_normalized(&self) -> bool {
        self.digits.iter().fold(true, |normal, &digit| { normal && digit < 10_u8 })
    }

    fn normalize(&mut self) {
        let leftover = self.digits.iter_mut().fold(
            0,
            |carry, x| {
                let original = *x as u16;
                let carry_sum: u16 = original + carry as u16;
                let (div, modulo) = (carry_sum / 10, carry_sum % 10);
                *x = modulo as u8;
                div as u8
            });
        let (div, modulo) = (leftover / 10, leftover % 10);
        if modulo > 0 {
            self.digits.push(modulo);
        }
        if div > 0 {
            self.digits.push(div);
        }
    }
}

impl std::ops::Add for MediocreBigint {
    type Output = MediocreBigint;

    fn add(self, rhs: Self) -> Self::Output {
        let mut lhs = self;
        lhs += rhs;
        lhs
    }
}

impl std::ops::AddAssign for MediocreBigint {
    fn add_assign(&mut self, rhs: Self) {
        // Delegate to the reference implementation
        self.add_assign(&rhs);
    }
}

impl std::ops::AddAssign<&MediocreBigint> for MediocreBigint {
    fn add_assign(&mut self, rhs: &MediocreBigint) {
        let mut left_iter = self.digits.iter_mut().peekable();
        let mut right_iter = rhs.digits.iter().peekable();
        let mut carry: u16 = 0;

        for (left, right) in PeekingZip::new(&mut left_iter, &mut right_iter) {
            // Handle when we have both values
            carry += *left as u16 + *right as u16;
            let (div, modulo) = (carry / 10, carry % 10);
            *left = modulo as u8;
            carry = div;
        }

        for left in left_iter {
            // Handle leftover self values (guaranteed no rights)
            if carry == 0 {
                return;
            }
            carry += *left as u16;
            let (div, modulo) = (carry / 10, carry % 10);
            *left = modulo as u8;
            carry = div;
        }

        for right in right_iter {
            // Handle leftover rhs values (guaranteed no lefts)
            carry += *right as u16;
            let (div, modulo) = (carry / 10, carry % 10);
            self.digits.push(modulo as u8);
            carry = div;
        }

        while carry > 0 {
            let (div, modulo) = (carry / 10, carry % 10);
            self.digits.push(modulo as u8);
            carry = div;
        }
    }
}

impl std::ops::Mul for MediocreBigint {
    type Output = MediocreBigint;
    fn mul(self, rhs: Self) -> Self::Output {
        // Use the optimized MulAssign implementation
        let mut result = self.clone();
        result *= rhs;
        result
    }
}

impl std::ops::MulAssign for MediocreBigint {
    fn mul_assign(&mut self, rhs: Self) {
        // Delegate to the reference implementation
        self.mul_assign(&rhs);
    }
}

impl std::ops::MulAssign<&MediocreBigint> for MediocreBigint {
    fn mul_assign(&mut self, rhs: &MediocreBigint) {
        // Handle empty cases
        if self.digits.is_empty() || rhs.digits.is_empty() {
            self.digits.clear();
            return;
        }
        
        // Special case for single digit multiplication to avoid unnecessary allocations
        if rhs.digits.len() == 1 && rhs.digits[0] < 10 {
            let r_digit = rhs.digits[0];
            if r_digit == 0 {
                self.digits.clear();
                return;
            }
            if r_digit == 1 {
                return; // Identity
            }
            
            let mut carry = 0u16;
            // Multiply in place
            for digit in &mut self.digits {
                let product = (*digit as u16) * (r_digit as u16) + carry;
                let (div, modulo) = (product / 10, product % 10);
                *digit = modulo as u8;
                carry = div;
            }
            
            // Handle any remaining carry
            while carry > 0 {
                let (div, modulo) = (carry / 10, carry % 10);
                self.digits.push(modulo as u8);
                carry = div;
            }
            return;
        }
        
        // For general case, we need a separate result vector
        // Store original digits and clear self to reuse it
        let original_digits = std::mem::take(&mut self.digits);
        let original_self = MediocreBigint { digits: original_digits };
        
        // Pre-allocate result with enough capacity for the worst case
        let mut result = MediocreBigint::new();
        result.digits.reserve(original_self.digits.len() + rhs.digits.len() + 1);
        
        // For each digit in rhs, multiply it with all digits in original_self
        for (i, &r_digit) in rhs.digits.iter().enumerate() {
            // Skip multiplication by zero
            if r_digit == 0 {
                continue;
            }
            
            let mut partial_result = Vec::with_capacity(i + original_self.digits.len() + 2);
            
            // Add zeros for the shift based on position
            partial_result.extend(std::iter::repeat(0).take(i));
            
            let mut carry = 0u16;
            
            // Multiply each digit of original_self by the current digit of rhs
            for &l_digit in original_self.digits.iter() {
                let product = (l_digit as u16) * (r_digit as u16) + carry;
                let (div, modulo) = (product / 10, product % 10);
                partial_result.push(modulo as u8);
                carry = div;
            }
            
            // Handle any remaining carry
            while carry > 0 {
                let (div, modulo) = (carry / 10, carry % 10);
                partial_result.push(modulo as u8);
                carry = div;
            }
            
            // Create partial_bigint without cloning
            let partial_bigint = MediocreBigint { digits: partial_result };
            
            // Add this partial result to the total
            result += partial_bigint;
        }
        
        // Move the result back into self
        self.digits = result.digits;
    }
}

impl std::fmt::Display for MediocreBigint {
    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
        assert_eq!(self.is_normalized(), true);

        // Read digit by digit and write out char by char
        if self.digits.len() > 0 {
            self.digits.iter().rev().map(ToString::to_string).collect::<String>().fmt(f)
        } else {
            0u8.fmt(f)
        }
    }
}

impl std::str::FromStr for MediocreBigint {
    type Err = std::num::ParseIntError;
    fn from_str(s: &str) -> Result<Self, Self::Err> {
        // Read char by char and write out digit by digit
        let mut segments = if s.len() > 0 {
            Vec::with_capacity(s.len())
        } else {
            Vec::new()
        };

        for char in s.chars() {
            segments.push(u8::from_str_radix(&char.to_string(), 10)?);
        }
        segments.reverse();
        Ok(MediocreBigint { digits: segments })
    }
}

fn read_str() -> String {
    let mut response = String::new();
    std::io::stdin()
        .read_line(&mut response)
        .expect("Failed to get input");
    response.trim_end().to_string()
}

fn solve(walk: &str) -> String {
    use std::str::FromStr;

    let mut accumulator = MediocreBigint::from_str("1").unwrap();
    let mut multiplexor : MediocreBigint = accumulator.clone();

    let five = MediocreBigint::from_str("5").unwrap();
    let three = MediocreBigint::from_str("3").unwrap();
    let two = MediocreBigint::from_str("2").unwrap();
    for step in walk.chars() {
        match step {
            '*' => {
                accumulator *= &five;
                accumulator += &multiplexor;
                multiplexor *= &three;
            }
            'P' => { }
            'L' => {
                accumulator *= &two
            }
            'R' => {
                accumulator *= &two;
                accumulator += &multiplexor;
            }
            _ => panic!("This should not happen"),
        }
    }
    accumulator.normalize();
    accumulator.to_string()
}

fn main() {
    let walk = read_str();
    println!("{}", solve(walk.as_str()));
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_solve_ten_grand_star() {
        assert_eq!(solve("*".repeat(10000).as_str()), "751855912380967801394633390061446662398235167200763875913214356341885929642617606028366604437263362004228277392930875581219911647653369095247232534321936717788113136667409184340773167603160022006603289121537436843582444568591134871034093477185632902318592569642158822888313662303905599885935250117546236710913670398060792998913463492832275383728714680192723097394123632071170681226258183300524784559883559696557962997263019507634315809082241346754853056754013654805988057914893028334152409985529207112545763257843881742997708534647311596984884912858262285360415865028236090204289728865480618598704538143034209729178350457685585155032100360892328577787540449417799652208344580216048436179265245454718435498633244540653399235485475858769538352352220557354624665667451085473217761464664563908705328217813527242643147270338398073292535829978185575638478838693391757440613567403052239281985667715526612666418213272731510157115993838777464991499888587588560739983697122774251546309596410673260123683797191641423754081832187078520564360833558557965960628372227649088448860850816563736433837665083071556358179233174203205881811114620539432631572185363008613260469345910779475709874711833241061593233079557358187288902350478437819046874898036147181309242132784068878554143293734454999605723515417616909901933767960551634443452540012729995712985194418972650972431342188118528904668827886141508161366166440696147213647196644948724258153846862032165965840759650875020675660256504612608957168220471123294459419434894614012887305038388166667134192728785326217316122453863793000445367852956986164535198416366552106913264869631748739842538091579195365406871248298647413104443735903776289404434751664316345310725514397061816902595792814485431032675840286153818488952016308174615097914652146846567829672600061912903684253456540375039704238469664515034596322490984034752240212377601954811531616865074668535463402686949082196707237104533466206347245892793177565356351818599659455888294506646764027580164187692973361444963656024145601287418296828473481811621248515564450067324784882980397613178250766028133475650447954814643912671800998530366210014062687987490772208448001553492812262478882481088560806927588213062226338418288685790961813140423845344683665635047514986016587196500355797329594729784458990912094304232824157988714998969904210010852197073940725069313709001309494801583982659986129137586780285629933032532396703800371729762664657283257880621556854359461334343902796842930593586145070238476857943602230431926616079881649939935991314067431649003172144590365376364508858795279807274397474232317313623547497803492958911710477613061247218439997669362573446539318423342175875267790334274477116343419257406789339787795898857087776889320441857546702585729998814154088811968317892097248956354874633666422158421788076038571218891593129959016470023739880520203140223755991557485879450871615695873324010602371830188012781253710378122561282614719541174872381911029803681022916365890005672516943697361023335420870682327021386992910311943173134511326519423569831880528054416198662871373302821562706548534272428688830481517836870468128296710920375020600750376682195135974565674825894177188123244474719231436999757312285953113506377458919689488698726269140131424878688724655224912609725416007342137539871497019327782326867384639087130154308265758496724820863045600146419847776774802845467094764953114124945652278895849655646144418281602880317671211457002217638221633137761268576365049561822360638418201939707286850566382042741824930578018969135087595194323399316645300127890927809399159262546574572607198812820836992067718807586090392489451803166229548996238467654904631488524605302261687800863775923897904992568334299052773586181720168021542723828497133315687991827395623646937853016172570121177856270562190001362343043797013547600427716075912509337376181534731763002898516721134207967592889217109398021256926864947435081186672190162712183750281761297163253883334914407696822962558303617745049761675794458798945732842750638506765526948132641816918633765525070185758623416159027100509869945066091214947677307726676342996744897630691217085847925949523488683159999841068645828789178776084359446368866275397645306359675929138203877578394503182774590492680354866158776273368094917202560584428527770937079379649051524419989267097451364378398015848568893442283484109927119280576192796736556600528080965309017455716465969456281063967632109301838167949951394146911009205178253277049707607326332912464922115312885016780717226951152850976683233088743978870912633363894210558212100484587039709260047133523567478219673515188514809964734451491140725644643486442602330327880575625093234914498212917134739982133560730647862631427687310682825020722025468180128413152001046430323513977760850602349968686577908442774329275309124172250297886920136040295314100617517110832261653012812225528919912022873607168544049956574191842520270350486138399902683065655258178730536413230846631519711527338519775596129140684902551357119854727254257811960185027838960676209972220464029298629497145642209021081906515949204766147609199743308867992800822849444520785328770086683762901305807973762144014547438781284470948288430511060767908536846421393304807930900134617300730559888862181733241015777481578658550328759126049136369713658046834882501000106522311018189588438434935396152259905601026388864398582339381351856669431977354687550801321845478027134979749410464988018497683084419949123420385849915987148395073810401645161347811711182591908386549170184489359024447352140587619370560868622109838679516735081000582063359965795326124813281182432137853217982678798899575707098854253183996801577240582197789755342145274532723448688216227040186349005776571403400677033320995548621162632454834924067183116881807063216102373290521861695838297123388215943958558768895738258828889671895533800571945081747308366809398665110956069224458649587762298588379566857628473764600642132752116390461383773606952180395671828069400191761553401726413889074969113236260183930753112568287048079318833921792610113839452470260353753449920188939279899368188928072687683345045219094038475744457152254450213462317370797507034498652292087789709256727633131472856395887317727536484835839673307333160289582129536202979585591945990572163125740758677198577266415808755284533920962733533158816950860605393780121572760337513836472661985177604622406091130288542324855491684405804465809445195324769615309565635961281403802236125791863748770697460037000175941113825303206495448066543974725161219017706088075549306555010811460655899170638950824918550927155688063600621584765926424209987545033485719712027918837757316004906688321872416973570923947198251838226398558095899649994977789433129600529809308832509846574699646895042338319172695407873553641755442304187208977870432489532346206157133243059337205619447635005735040395948440820541599967030862405706296275866746635805069767029351948148228191768764087809466717399192641321912745144450215483541827527417570540170293468210204307000605735937");
    }

    #[test]
    fn test_solve_maximal_star() {
        assert_eq!(solve("*".repeat(30000).as_str()), "188895381537613718593729617782280608883775437037873756186308134013260981550309460405795544827536839512504002613040097010846188704103958945072801036090221089443258174589238667733871374725526589289615403163932932336794393851841854921597193529216992123897119549578706769372822665972631040644277287911983980734874506180500433626325096981152921702436550035328717692616354985819733406053575723996101458996022872583097711710095261923381333800813667423845004171941745180366731813624377065461517961887211581210876472968302200555836597952165516678309738506723985309528536532709507328023128984602325336134724723798466712369634173224279717200302347839186859560454849250276166727826686015938555275731134074031990901323430765689698898056628364941315050390034213654076640257267251972822736688118789267840684929187688798607882626042514683076762463802523736989453580834818368635105988007151135711329019607604212864640840237854922617113967179237204504536777689171387537416044672424262437617394621952267167245768095288781278633521378603058789530958527679461517011310938984600352984902954680727566198470413710796279183746797657213365479379219385803097514200263296955993826151336055008986673988494355557737068984739318399481154057108052416407095591319117792814269920021357373099095443603891897210049419809276192902699111989237431049335206041368778023915182043136305860140319792001166964177178986438681143729133472556428683724814862913691973980265737543625411164857440655972061767513546074308260688003936509662227216532598053853249172505982463104624636711021508255872498636020595514263738020334257736733540106657273638288284361537912963472884581978440345716428314554374375926785661323739073465191963177934285362350751535319021212661292084949879028562095394216284443284870471409524059134422835359456712254105162342413373996994518687537942484620686959874704230062272514699397693898681893818253079260545546676514773536090001833467366735483741339705766910824752075269922839200418597916859458912295466858651940468344342359733911264562873563707968685848012193099622789710241566969679958576403809707842573090983901603811231811559936344120971830388282048975468713302657975231840443900626945468189604416320607580006143144460222512001406586876538948483984711574151290084875924788363280936550418721755802612443268889832120972232497056364649018987646635494929596218603559810219301897165330046059123202726720083445405158896058123254039007775210139492130645336570207500592615424419690465216687077790067783054702813272132749128589867906303091882693816576265200112173271938600740779135883041382425760001882882471471825026659518764329467899831394175003389379413546200429115461163876268443199839053454044623566220827902672617443205486631434725778702277165548213490771935831273976364843701725083417167215665663750950873921465152554894842421558099067140854890423235827779913138634268921839359356107043532249215403161668898680620090963535172334026343921981020678531431663835472264402315245173054881615472431367217043713408331653505915208170356161898053383072720671773033821058568700215019368719462466771999929853694886323471138945208365800937251805942696103247522286795696417926615794722773612575003398349710142189648468978603804001060992359426616458951638011485683374628990210153405639407205689150874157092717858565873397496628325186055627606941682441389334415023213511859495980857760052687680567995762384427542774314602933934115977845349603018635240998249771020670589238569907471145856405910169571788434543508083405980161183323016330901437506727617060253741676346954694524632779592602870309786089300881104261811693287208378231303211087154194213303460221098255784753515641701119922476824223051525521452609225450084139810520375305026613100177960390733443606778790236534733858948186453133561604914545185004564357001088982127070140330064673310116196026095496984279296991450291990578202342782474815587549152905653848005447535008771745010428620145360049509719281721350511953146143183898724829772540969213734334506716477931416532560797369032837066247841044184628314948143763258867426151297082624289301395680408459894383825063329970887613170943986794506732102950684283166092009443568652062845419849782734838578592683028640237853500231290425924497978048186194021836557322727193913433432505172034679033079471155534326652507358051037258897173337988025294483336876740576250571022289006401294710850742965426068096500670457913427351818337083424972477863099708933956160499097148180251501980189952745173148989438219808187385659328514644018433348968955377395466823927558813240949887355052511936081345900497808217519561447082540672443651999010585867366652540223028206840935664230320769651500187016824213321387383574624132639348156682928129803424530605121859461391276344011320568001974462044267246483079819130015910987528082584563528920570383669991730241900978205339226038093571439730650390372668069945541741758064500340690500865600623029240210750024241911652183306024131864321694243078554727484988291817370447883401776722466793419320811868143129130007938358342938435366379682100555636211033118124902894195692968504782111029360386575969992334141547210480864904290126638896336185787205990523553438514787477006762368520014695051633695747610644843213479714650057879117485404501424679265321074220595368223998065418810559410008240376578461304167784630096778217522295726053034470247894474520023667818843566603191783038683664998578299267429640479764592175161758870190282396855627434064993053214810165791472436846322620208947574850183026496173138650878680628920011240266960324303053194096873768178589792778109391786123216387437587291526542403730121745433967195447666916224177455260133710204909794486533190758208416055617559607217670867077144963776590639227504576424884909340185951796258401238802791952459955747311061095400647299259749881341585780196860964514821632954369596442364681689886384833859699595246114150042015935740869000280095650968296049125170273721452396655718563262225225371919229747964043657071613372459537486176283891976416767470741304624980098590162289047173587612296610878931134134054331990265619626005404451016331277844415430065088244073929006036502001881296369465482441640431328050546969310506554831317669120123999279587266948341493455249931299371340845495999211286104889588719318408088875873577733002385121719498230041200050086184009404495129825122473868530623051586935179096929361894891577169602114217927666540301650623814373328466089250989932474858435110958255103203591440697376574779521674129971910036115844258785863434447883673225577414898403078581845645600182824670830918000121465115399920619352827316076090848046690571423847455632248850822608903556135515340659683917136817535506982064028582266574502692150516913817111557317702045122968940097538678295367042458976080421368662156617233739576542161455491778421053984657119678754490614145996031051218225632282986002477253939940227031274801786292757611642678241676090923975214126246604795436397335540691256325055414573016415674349140087583177696283380289657911711670218188629477213683388677911424941368039074922798550978886880953593398863892931121190144944487847788036025084968739679668430224460282812191808619773976523052215470109304065168586986453159432579751000039310357965368893646281627935358192022262010774489912105873329494338369723553922553234041317115397568058218691427428453314807732963107737176375259972306188369734198108440867877114771539887536167015453663744134129509103991247245513037225304116241748991172485849922735293331606633894364907961075369814458354754042659705826973934183070000248925883172480303695997166642158021901244600331940990917595736035660778526011692648001613963310527045608126154387304940337692614298776548842280328057224953208609722658521104095074547119538869791760456046813036136415312501652084315536083623394545902348336636026159628570986237721119518589394780300786321804100450817225260529288872605696253417675477389604841435703088386882498592134940262383004285450626847338668732703176828014266168909337958323970549816692084735064092559225094856457857171327458844706707590536041730790642888197803453711337522469609764051510991525417955510887341259733214173586334241093823931932974066342370846357337963873748483248327966463824767849574462916416847881994222622082819508871052794672769083561394119937026034161186092504002491269435965918374408969997610221290607354839690487472782842498364898253918095290461481385991116999099039816285001259294973533963325431862201977980082297701684379134183225089068049420264862582668868961162088900082860244115798764883007453670117174560676960657562967475939874246020228739161810128693228444489896373569145694992322467841311673167288472411116681638062782400098134430710425122051441086051718007874575265050607732480292746478482077877325564869957577688717410743893705661651133232489613824771052655862450432987229384281548709874196966472823335576663706472804876284563543323877113240432951703446576913056513557693021804366485375314192345034178740309444021619927515024813482758672209088218041673559792061464180869588929346893591525285730816988857083393341011446195123531171107827692256990543684364831785858243753148282146889277389871308129792140041813580382389666469270621769191007122513021044023200284705222704759350299447439651655775966616981535878720211979123021103036515215651348917206660560666549632961746897205211117379301829144738971147064521364160837361647666672696223881669241202628460738666864313474299643282872348565318699891881958401334459500275002143373100487188132698835385128362549422821763479217955121385939123473290829084550570262576201713565122510611461921471901268562369071950932041560775388243673444264029293697547630071840715629704487610749430077557009403519544388672979084786472611704133823339400888315402771475869508076306809608156513500619170043576687856571953613584917464846115952551203201826207194923102953903291612988672205412223117214165931354927082175916305677264527561801932485008426397629543261670095239008662488770328441591638938085455569565253933883624564046024504275512939650888020135086056331602112259564897196283054485267177957301263763815928682408187688211320376257933636779085773021726720838385724926042801422379325088547521369655600879738155388787901811529579336206477967920088007423318482807882787870426080747719984374431747327810432139656550560144455313226666056901637290190812515364063142193219612404460474405431744625088817312630207333000939999156139424304559834473625901700609759873745158813206051686028142871136353257391433478117918503572218576844384836777075668417645388022724740898177725373832659184966250242356264582194235391100400179459632167216727019525079207068642793244425901646110926070834340033661218117541431234844421664955485718230380027303583864031344908545171157026849783906888830743401575118507055617001150578822602632811213504437036239151620377385701536981319341187881300408982223870442187990934262332134595318917472333392593538793754196305841875383031866782632844176377854541248653707168738761552596576303767108953417471513743098030881644700462971035264108473291646882431381376243648813647518212502927634028968906694638359451994536592503464802610217821924655880694866197868713174502833691958284531026633500283498277792654397211016558073507761184974828553794871833093756518283710095060687115960266781723665534339612118213115297246683377371180095584655725241981788582163222980034210094379485474623930530475044904117377243701738531084045857694615497699276340391087126902176471902033551702502203292227796328218910021509963981261991087874122433261688078780665183340881973165580199838362122065193099562704603778799470393197470990692760134703258986262999125487805734390855217773848204550958916526450653943102954750082940317774423037745306299972576379752174517387032247360810502600236396511804739323212228155067397064331889155453148896928664345431954339210647362719342776022955453656345477416512601108792832417359538987133459060170484876710363349775183756508905353657581805892491627785371177771027128379249286382757208397700663467463752008852381198615882315341816321235740998880674327585480591799103940561362571545181640431931442310030374326047519843038864866648862882251239746151319239793879582909973029597810761610020524210503119103899290557524596379536707236356770742870861315817355734192470192980880189183765564948320029220018725080433082258758814032871870425434272488706197149562279660423841566535283670329831912687692936304183967191667553532093739759679418890839165123017959623655246027603790483194704646678666061746712061681309056794411533588501174947020129009970321492158142066911951839559670925497916641056122798391842062282360084346001495560561516716982379133825057507951426967447248225982573558783984891269296109087499105992480299160731941895713876864717687859039588894936309744340835327556376822381229979127038624765861585423245440208476595438738498256504053723162215679912828970967695138262040306762059668606881771862896510342396454489036546044249858908768056044754472442330166351891200614877227619723010245367896276085418821000527421229039695971646148302674181161827537538057258069822753312696123383021924859678984763109294560926082711389563062259656146721228889836577406405383899470255272431297266609396462605870709635691174556443804750328098628156152094516720411444697428950880558841508701964670395946732608686480497784564812827037900813881827165814502641326452411493296430867115129913121725181006258057067442939340098529108678304035751257639530414407215211476080252961371926193173962122048550108544543550310322338046124855776728132047496716490543806444408843720605563717006223931112698808665581452151941816458011439083813743470132435855663455695219597321801079555018583935583832265431196001090567702093518094694921582141942279601721454672420436054455784075486799116757313209750612639354422584377983719462484750475403718469504917509921089591308858517260021483041831109960725015926891400004580330063035789686453088198359487012250909247886153437334480003482815245231429305945880584482849838085643837258916111951338626311353861558358145985538725450888916865170046754681076440175869868196164485359901119705984343131870136016698777924477190099781507287618027407505710084938306278445950203146992599669264973430390215373979141976494242138580575746252913781184632588794234599006491499384355738353596012336941249033708220746549071470231555083374778606197143355396178534445656366661459611348917609944266360396292879513902786463886775271640020354115670382531582654364031932265063738627470565754466778849170346510139288279539971970816904612433515446737072997723508906903369037907047886659657471788208199359381810555557964415775204329433775113392787321207048784038847196232243836180367803033811976679429821812394932646777245718569038998717072714211821481098258263910862610842546014341104587850902111916540467864679214022440768120896149841410623691050549435380141442620851242391111923447216591749282762887672899152016402083476952283571733174990059906134581196285442431186506562740824759954133788930726772829611388458956160390514237109253646616820990820453552607091274121003568564316444930557829777633412312279235642002225200727502117503282478601810820604650443855721547087279957132250356358095027251523450953488600858660054435403445049407415421047877145736478990747217485553262652305855337662842883844370044505969160775939865273219534088286954220408621669386668108019870107133538037784303212455266100272211189508912005037015995461039148482492623841151702938450766891147394593615263319854039046151016089618116382053799732278937870033869528389425779235515855540729077414293091984508511885770535757772189024729247582401310347579267316159589656313220478312440129505664201171908378837149417759743422146310123545011461831930053568098710163689659392027497768493054487610287291855745827181511952287407347291247861729623808274638671265302379659094508741852687803120762434931128668172294663880661345061873819820321716415698533365527534548355606095873165889420348809356436255571978695712683443786592264167324483002598358401945587243265732542617195308340165895611517024546352152104757489382776012696441737569868612500075080405200647205485649773262572094796661068377611971836134080631090876987221779598326425219249262641865343757461585124331927417667579456209943607928297358007403169271481277742320220761152332897237397041995142691464665785034830927120321400376128018180153146609073341889075409768538455795806402290578449893015202901642806709606608515099880999523048846902068564508088835733999541174888408655380116148246189053197183495628950435025467993075100742893672127193655165201907623259312153471780342946319098739292999702296978307061714004548952155719345050604298333280715313438275100879121640462763052058708084322999569795168781828433952008971185058797794713614945959556506855995188113090959303233519057046117603358036444650267884056015709035308992201168501291524930165321066933666025116961686968476513876955666728329120994024787627619309113546183745113717609286692850730159213452143543468023374988681253535089606416074265743264329533189897810861218358947701682608591512713022473694069646137743019900759222129505997541841919690550295067115777530549439578630456368529044420367497152460769162063758420175555791242368344217251526074107406717146587124223709662951508228699398549260462763492642157744555472346235892930484183451704552854893411926881554576843747580518964150267469798265668546401161054691810291184602978330783680998631703436768394675228876882897349757897788737871738590241524970842533076902028080891270723422524047069404457026940371110205249649400380392890941158092397535974794881899675917666405315608587217397966260800903995180343323561869517938694734708044478067005343542939300436980339216215385407798515452446237765072285735596467209705642926715136573025509766979509976766565029889140691163363267929199588075477654378900639480778447815861992347638459522697510609717330547728010615709156432384695598753128177483990547879844093129646720731731060537856908883813807614982549063919519280111231592859745458214724757562411529432487200397617239199400491157552396525373265443724842811253693228022973963336269164769223036902457327882308673368697803212627377928712778918327321788375567950982562971812384989915648387926942142820155638712082885247152517468805025515170958524325182146367177889343513252688604971248215114822846216423183985245075238527852250365127048482758135615592192302751546091373332607688136894017329133836826284454672052166941477450477021809657838624556332261745064111144739852440434071818050006797010159256635611452030478535927206724556758925376880761361103180317257470326083391136346836203218719581155288883304960121316673091098967753862250733077371017843557543093972214275009443423471248974759309805085248727040800012827622699362710906335109118254266407840584899753112130532212929186743473392658946933734479095373134337749396515628623695418385790742066208787557922161687908677233084783175537758353479263724325385147963146076444428457247804104321888207742549428428570316368591136910516817134743804262381862882309119841808842213539753744536723079868956760578986924967347104361682703823068040748932030882305828031867592619598849056574454895649085028205450604718665614849501131504258209714635230291487799822754505868114910661698083782607068446944861691976839529777437381482923138117114207189905041615092506963626375331810677089961113169510410446117195366190251247479424693102818599653807431835228438319023425972356437920747982723648552605790002632322116401313276478523149329452142290276744978671114490180453301700994148632903390176893057864634335619664155212211062049223255413636449979067109374181294111373140457798645173537462066867404512023985232532991727181307409211272579718175287733737949557695081104264517291849088858174531839780881373367551489127735604961620280974707471642760953537755471225493944359775800415691140610128786548781982384646264132505867141526189310646165063094488974237354726054192681253992990394750244012676191049210192922587662502068894993139392644978115338716893880561237781769712465466884132743873038656485185909594538047603731983748351933687013496135728315542018526186338300794193741296601756335786139967490764022739990082488292059911062240672834714776398759394492715829107865082743056148877008907983523389906140679255803216977534623504909396108084489931557862361955574263766045637598568161544152665222947883578332401008411222943970848876948687164393584383992950013639232974474983976246094455494382510081603197976229833809914893590778920739678964666670659147244371389240040410001651687985154259287142636318686899839622034074769527155093185910499372144529336256253510858096388449198909030752361574978930296040826391535147208611041674900718124709891291499855654410282841810221245395278788076458847762957628975832453621782348157093735464531285888145353961557215793177562636377550556395202515425051088266906996697846126243572684935060412115922202464002840657733972193670100025999007286280349846633505559386422696579892215439983016389549708110668818371609639177937100197158430354957635341828425756005435966487178535937");
    }

    #[test]
    fn test_solve_middle_star() {
        assert_eq!(solve("P*P"), "6");
    }

    #[test]
    fn test_solve_repeated_alternating() {
        assert_eq!(solve("LLLLLRRRRRLLLLLRRRRRLLLLLRRRRRLLLLL"), "35400942560");
    }

    #[test]
    fn test_solve_left_star() {
        assert_eq!(solve("L*"), "11");
    }

    #[test]
    fn test_solve_right_star() {
        assert_eq!(solve("R*"), "16");
    }

    #[test]
    fn test_solve_double_star() {
        assert_eq!(solve("**"), "33");
    }

    #[test]
    fn test_solve_right_star_right() {
        assert_eq!(solve("R*R"), "35");
    }

    #[test]
    fn test_solve_left_star_right() {
        assert_eq!(solve("L*R"), "25");
    }

    #[test]
    fn test_add_zero() {
        let a = MediocreBigint { digits: vec![1, 0, 0, 1, 1] };
        let zero = MediocreBigint::new();
        assert_eq!(zero.to_string(), "0");
        let c = a.clone() + zero.clone();
        assert_eq!(c, a);

        let d = zero + a.clone();
        assert_eq!(d, a);
    }
    
    #[test]
    fn test_mul_zero() {
        let a = MediocreBigint { digits: vec![1, 0, 0, 1, 1] };
        let zero = MediocreBigint::new();
        assert_eq!(zero.to_string(), "0");
        let c = a.clone() * zero.clone();
        assert_eq!(c.to_string(), "0");

        let d = zero.clone() * a.clone();
        assert_eq!(d.to_string(), "0");
    }
    
    #[test]
    fn test_mul_small() {
        let a = MediocreBigint { digits: vec![2] };
        let b = MediocreBigint { digits: vec![3] };
        let c = a * b;
        assert_eq!(c.digits, vec![6]);
    }
    
    #[test]
    fn test_mul_carry() {
        let a = MediocreBigint { digits: vec![7] };
        let b = MediocreBigint { digits: vec![8] };
        let c = a * b;
        assert_eq!(c.digits, vec![6, 5]);
    }
    
    #[test]
    fn test_mul_larger() {
        use std::str::FromStr;
        let a = MediocreBigint::from_str("123").unwrap();
        let b = MediocreBigint::from_str("456").unwrap();
        let c = a * b;
        assert_eq!(c, MediocreBigint::from_str("56088").unwrap());
    }

    #[test]
    fn test_add_small() {
        let a = MediocreBigint { digits: vec![2] };
        let b = MediocreBigint { digits: vec![2] };
        let c = a.clone() + b;
        assert_eq!(c.digits, vec![4]);
    }

    #[test]
    fn test_add_big() {
        let a = MediocreBigint { digits: vec![2] };
        let b = MediocreBigint { digits: vec![0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2] };
        let c = a.clone() + b;
        assert_eq!(c.digits, vec![2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2]);
    }

    #[test]
    fn test_add_carry() {
        let a = MediocreBigint::from_str("1776").unwrap();
        let b = MediocreBigint::from_str("76").unwrap();
        let mut c = a + b;
        c.normalize();
        use std::str::FromStr;
        assert_eq!(c, MediocreBigint::from_str(&(1776 + 76).to_string()).unwrap());
    }

    #[test]
    fn test_add_mega_denorm() {
        let a = MediocreBigint { digits: vec![255] };
        let mut b = a.clone();
        b.normalize();
        assert_eq!(a.digits, vec![255]);
        assert_eq!(b.digits, vec![5, 5, 2]);

        let mut c = a.clone() + a.clone();
        let mut d = a.clone() + b.clone();
        let mut e = b.clone() + b.clone();

        c.normalize();
        d.normalize();
        e.normalize();
        assert_eq!(c, d);
        assert_eq!(d, e);
    }

    #[test]
    fn test_create() {
        let int = MediocreBigint::new();
        assert_eq!(int.digits.len(), 0);
    }

    #[test]
    fn test_empty_is_zero() {
        let int = MediocreBigint::new();
        assert_eq!(int.to_string(), "0");
    }

    #[test]
    fn test_is_normalized() {
        let a = MediocreBigint { digits: vec![] };
        let b = MediocreBigint { digits: vec![2, 1, 1] };
        let c = MediocreBigint { digits: vec![0, 0, 1, 20]};
        assert!(a.is_normalized());
        assert!(b.is_normalized());
        assert_eq!(c.is_normalized(), false);
    }

    #[test]
    fn test_clone() {
        let a = MediocreBigint { digits: vec![1, 1, 1, 2, 1] };
        let mut b = a.clone();
        assert_eq!(a, b);
        b.digits[0] = 2;
        assert_ne!(a, b);
    }

    #[test]
    fn test_normalize() {
        let mut a = MediocreBigint { digits: vec![1, 10, 1, 1, 1] };
        let b = a.clone();
        assert_eq!(a, b);
        a.normalize();
        assert_ne!(a, b);
        assert!(a.is_normalized());
        assert!(a.digits.eq(&vec![1, 0, 2, 1, 1]));
    }

    #[test]
    fn test_normalize_zero() {
        let mut a = MediocreBigint { digits: vec![] };
        a.normalize();
        assert_eq!(a.digits, vec![]);
    }

    #[test]
    fn test_normalize_create_digit() {
        let mut a = MediocreBigint { digits: vec![10] };
        a.normalize();
        assert_eq!(a.digits, vec![0, 1]);
    }
}
